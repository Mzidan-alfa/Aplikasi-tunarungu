const database = {
    1: { judul: "KARAKTERISTIK DAN KLASIFIKASI MATERI SERTA PERUBAHAN FISIKA DAN KIMIA", icon: "ðŸ§ª", color: "blue", isi: [
        "Coba sadari sejenak. Kalian duduk di kursi. Kalian memegang ponsel atau buku. Kalian bernapas. Semua yang sedang kalian sentuh, rasakan, dan hirup itu disebut materi. Materi bukan sesuatu yang jauh dari kehidupan kalian. Materi adalah bagian dari keseharian. Tetapi apa sebenarnya materi itu?",
        "Materi adalah segala sesuatu yang memiliki massa dan menempati ruang. Mari kita pahami pelan-pelan. ",
        "Ketika kalian mengangkat tas sekolah, terasa berat, bukan? Rasa berat itu menunjukkan bahwa tas memiliki massa. Ketika tas diletakkan di meja, tas itu mengambil tempat. Artinya tas menempati ruang. Jika sesuatu memiliki massa dan menempati ruang, maka itu disebut materi.",
        "Sekarang mungkin muncul pertanyaan: â€œBagaimana dengan udara? Tidak terlihat, apakah termasuk materi?â€ Jawabannya: ya. Udara bisa mengisi balon hingga mengembang. Udara bisa terasa ketika angin menyentuh kulit. Itu artinya udara memiliki massa dan menempati ruang. Jadi, terlihat atau tidak terlihat, selama memiliki massa dan menempati ruang, tetap disebut materi.",
        "MATERI TERSUSUN DARI PARTIKEL. Sekarang bayangkan sebuah batu. Jika batu dipecah menjadi bagian lebih kecil, lalu lebih kecil lagi, sampai sangat kecil sekali  pada akhirnya batu itu tersusun dari bagian-bagian sangat kecil yang disebut partikel. Partikel tidak bisa diraba atau dilihat langsung oleh manusia.",
        "Tetapi keberadaannya dibuktikan melalui penelitian ilmiah. Semua benda di sekitar kita tersusun dari partikel.Yang membedakan padat, cair, dan gas adalah jarak dan gerakan partikel tersebut.",
        "WUJUD MATERI: PADAT, CAIR, DAN GAS. Sekarang kita hubungkan dengan pengalaman sehari-hari.",
        "A. Padat. Bayangkan kalian memegang meja atau buku. Bentuknya tetap. Tidak berubah walaupun dipindahkan. Mengapa? Karena partikel-partikel penyusunnya tersusun sangat rapat dan hampir tidak bisa bergerak bebas. Bayangkan orang-orang berdiri sangat berdesakan di ruang sempit. Mereka sulit bergerak. Itulah gambaran partikel pada benda padat. Karena itu, benda padat sulit berubah bentuk.",
        "B. Cair. Sekarang bayangkan air yang kalian minum. Jika dituangkan ke gelas, bentuknya mengikuti gelas. Jika dipindah ke botol, bentuknya mengikuti botol. Mengapa? Karena partikel pada benda cair lebih renggang dibanding padat. Mereka masih berdekatan, tetapi bisa bergeser satu sama lain. Itulah sebabnya air bisa mengalir. Namun jumlah air tetap sama. Yang berubah hanya bentuknya.",
        "C. Gas. Sekarang tarik napas perlahan. Udara masuk ke paru-paru kalian. Udara tidak memiliki bentuk tetap. Ia akan memenuhi ruang yang tersedia. Jika parfum disemprotkan di satu sudut ruangan, baunya akan menyebar. Itu karena partikel gas sangat renggang dan bergerak sangat cepat ke segala arah.",
        "PERUBAHAN WUJUD: APA YANG SEBENARNYA TERJADI?",
        "Ketika es dibiarkan di luar freezer, es mencair menjadi air. Apa yang berubah? Partikelnya tidak berubah jenisnya. Air tetap tersusun dari partikel yang sama. Yang berubah hanyalah jarak dan gerakannya. Saat dipanaskan, partikel bergerak lebih cepat dan menjauh. Saat didinginkan, partikel bergerak lebih lambat dan mendekat. Karena tidak terbentuk zat baru, ini disebut perubahan fisika. Zatnya tetap sama.",
        "MENGGOLONGKAN MATERI. Sekarang kita belajar mengelompokkan materi. Materi dibagi menjadi dua kelompok besar:",
        "A. Zat Tunggal. Zat tunggal terdiri dari satu jenis zat saja. Contohnya emas murni. Zat tunggal dibagi lagi menjadi: 1. Unsur,2. Senyawa",
        "Unsur adalah zat paling sederhana dan tidak bisa diuraikan lagi secara kimia biasa. Senyawa terbentuk dari dua atau lebih unsur yang bergabung secara kimia. Contohnya air. Air terbentuk dari hidrogen dan oksigen. Sifat air berbeda dari sifat hidrogen dan oksigen. Itu tanda bahwa telah terbentuk zat baru.",
        "B. Campuran. Campuran adalah gabungan dua zat atau lebih tanpa reaksi kimia. Contoh: air gula. Gula tetap gula. Air tetap air. Mereka hanya bercampur, tidak membentuk zat baru. Campuran bisa dipisahkan kembali.",
        "PERUBAHAN FISIKA DAN PERUBAHAN KIMIA",
        "Sekarang kita perjelas perbedaannya. Perubahan Fisika. 1.Tidak menghasilkan zat baru.2.Hanya mengubah bentuk atau wujud.3.Biasanya bisa kembali seperti semula. Contoh: Es mencair dan Air membeku.",
        "Perubahan Kimia. 1.Menghasilkan zat baru.2. Sifat zat berubah.3. Sulit kembali seperti semula. Contoh:Kayu dibakar menjadi abu. Ketika kayu terbakar, terjadi reaksi kimia antara kayu dan oksigen. Susunan partikelnya berubah total. Itulah sebabnya tidak bisa kembali menjadi kayu.",
        "PENUTUP. Sekarang kalian memahami bahwa: Materi ada di mana-mana. Materi tersusun dari partikel. Perbedaan wujud materi ditentukan oleh jarak dan gerak partikel. Materi dapat diklasifikasikan menjadi zat tunggal dan campuran. Perubahan materi bisa berupa perubahan fisika atau kimia. Ilmu ini membantu kalian memahami perubahan yang terjadi di sekitar kalian setiap hari. Jika gula dilarutkan ke dalam air panas, lalu air tersebut menguap hingga tersisa kristal gula kembali, perubahan apa saja yang terjadi selama proses tersebut? Jelaskan bagian mana yang termasuk perubahan fisika dan mengapa."
    ]},
    2: { judul: "SISTEM PENCERNAAN MAKANAN ", icon: "ðŸŽ", color: "orange", isi: [
        "Halo semua. Hari ini kita akan membahas sistem pencernaan makanan dengan lebih mendalam. Dengarkan dengan tenang. Bayangkan prosesnya secara runtut. Gunakan imajinasi, dan logika berpikir kalian untuk memahami setiap tahapan. ",
        "1.	MENGAPA KITA PERLU MAKAN?. Bayangkan tubuh kalian seperti sebuah sistem kerja yang tidak pernah berhenti. Bahkan saat tidur, organ tetap bekerja. Jantung memompa darah.Paru-paru mengatur pertukaran oksigen. Otak mengatur seluruh sistem tubuh. Semua aktivitas itu membutuhkan energi. Energi berasal dari makanan. Saat kadar gula dalam darah menurun, tubuh mendeteksi kondisi tersebut. Otak, khususnya bagian yang disebut hipotalamus, menerima sinyal bahwa cadangan energi mulai berkurang. Otak kemudian memicu rasa lapar.",
        "Rasa lapar adalah mekanisme biologis untuk mempertahankan kehidupan. Energi diukur dalam kilokalori. Dalam kehidupan sehari-hari, istilah â€œkaloriâ€ pada label makanan sebenarnya berarti kilokalori. Selain untuk bergerak, energi juga digunakan untuk:1. Menjaga suhu tubuh tetap stabil.2. Memperbaiki sel yang rusak.3. Membentuk sel baru.4. Menghasilkan hormon dan enzim.",
        "2.	ZAT GIZI YANG DIBUTUHKAN TUBUH. Tubuh membutuhkan enam zat gizi utama:1. Karbohidrat, 2. Protein, 3. Lemak, 4. Vitamin, 5. Mineral, 6. Air. Karbohidrat, protein, dan lemak disebut zat gizi makro karena dibutuhkan dalam jumlah besar. Vitamin dan mineral disebut zat gizi mikro karena dibutuhkan dalam jumlah kecil tetapi sangat penting. Air termasuk zat gizi esensial karena tanpa air, kehidupan sel tidak dapat berlangsung. Dalam pembelajaran biologi, penting memahami bahwa setiap zat gizi memiliki fungsi spesifik namun saling bekerja sama dalam sistem tubuh.",
        "3.	KARBOHIDRAT. Karbohidrat adalah sumber energi utama tubuh. Bayangkan nasi atau roti. Di dalamnya terdapat pati, yaitu rangkaian panjang molekul gula. Di dalam mulut, air liur mengandung enzim amilase. Enzim ini mulai memecah pati menjadi molekul yang lebih kecil. Di usus halus, proses pemecahan dilanjutkan hingga terbentuk glukosa. Glukosa diserap oleh dinding usus halus melalui vili, yaitu tonjolan kecil seperti jari yang memperluas permukaan penyerapan.",
        "Glukosa masuk ke aliran darah dan dibawa ke sel. Di dalam sel, tepatnya di mitokondria, glukosa diolah melalui respirasi seluler untuk menghasilkan ATP (Adenosin Trifosfat), yaitu bentuk energi yang dapat digunakan sel. Satu gram karbohidrat menghasilkan sekitar empat kilokalori. Jika jumlah glukosa berlebih, tubuh menyimpannya dalam bentuk glikogen di hati dan otot. Jika cadangan penuh, kelebihan karbohidrat dapat diubah menjadi lemak.",
        "4.	PROTEIN. Protein tersusun atas asam amino. Bayangkan protein seperti rantai panjang yang harus dipotong menjadi bagian kecil sebelum digunakan. Di lambung:1. Asam klorida menciptakan suasana asam. 2. Enzim pepsin memecah protein menjadi peptida. Di usus halus: Enzim tripsin dan enzim lain dari pankreas melanjutkan pemecahan hingga menjadi asam amino. Asam amino diserap dan digunakan untuk:1. Membentuk otot. 2. Memperbaiki jaringan. 3. Membentuk enzim. 4. Membentuk hormon. 5. Membentuk antibodi.",
        "Protein juga menghasilkan empat kilokalori per gram, tetapi fungsi utamanya adalah sebagai zat pembangun. Dalam kondisi kekurangan energi berat, tubuh dapat memecah protein otot untuk dijadikan sumber energi. Ini sebabnya kekurangan gizi dapat menyebabkan penyusutan otot.",
        "5.	LEMAK. Lemak menghasilkan energi paling besar: sembilan kilokalori per gram. Karena tidak larut dalam air, lemak memerlukan proses khusus. Hati menghasilkan empedu. Empedu disimpan di kantung empedu. Empedu membantu memecah lemak menjadi butiran kecil melalui proses emulsifikasi. Setelah itu, enzim lipase dari pankreas memecah lemak menjadi asam lemak dan gliserol. Lemak berfungsi untuk: 1. Cadangan energi. 2. Melindungi organ vital. 3. Menjaga suhu tubuh. 4. Membantu penyerapan vitamin A, D, E, dan K.",
        "6.	VITAMIN. Vitamin bekerja sebagai pengatur reaksi kimia dalam tubuh. Vitamin larut lemak: A, D, E, K. Vitamin larut air: B dan C. Fungsi penting:1. Vitamin A â†’ penglihatan.2. Vitamin D â†’ kesehatan tulang.3. Vitamin E â†’ perlindungan sel.4. itamin K â†’ pembekuan darah.5. Vitamin B â†’ metabolisme energi. 6. Vitamin C â†’ pembentukan kolagen dan daya tahan tubuh. Kekurangan vitamin dapat menyebabkan gangguan spesifik, misalnya:1. Kekurangan vitamin C menyebabkan sariawan berat dan gangguan jaringan.2. Kekurangan vitamin D menyebabkan tulang rapuh.",
        "7.	MINERAL. Mineral adalah unsur anorganik penting. Contoh:1. Kalsium â†’ tulang dan gigi.2. Zat besi â†’ hemoglobin.3. Natrium & kalium â†’ impuls saraf.4. Iodium â†’ hormon tiroid. Ketidakseimbangan mineral dapat menyebabkan gangguan fungsi tubuh, seperti:1. Kekurangan zat besi â†’ anemia.2. Kekurangan iodium â†’ gondok.",
        "8.	AIR. Sekitar 60% tubuh manusia adalah air. Fungsi air: 1. Pelarut zat gizi. 2. Pengatur suhu tubuh. 3. Media transport zat. 4. Membantu ekskresi sisa metabolisme. Dehidrasi dapat menyebabkan gangguan konsentrasi, kelelahan, hingga gangguan organ.",
        "9.	PROSES PENCERNAAN SECARA BERURUTAN. Bayangkan perjalanan makanan secara runtut. Mulut: Pengunyahan (pencernaan mekanik) dan kerja enzim amilase (pencernaan kimia). Kerongkongan: Gerak peristaltik mendorong makanan ke lambung. Lambung: Pengadukan makanan. Asam lambung membunuh bakteri. Pepsin memecah protein.",
        "Usus halus: Tempat utama pencernaan dan penyerapan. Terdiri dari duodenum, jejunum, ileum. Di sinilah enzim pankreas bekerja maksimal. Vili memperluas permukaan penyerapan. Zat gizi masuk ke darah dan limfa. Usus besar: Menyerap kembali air. Bakteri baik membantu fermentasi sisa makanan. Membentuk feses. Anus: Tempat pengeluaran sisa makanan.",
        "10. GANGGUAN SISTEM PENCERNAAN. Beberapa gangguan yang perlu dipahami: Gastritis â†’ radang lambung. Diare â†’ kehilangan cairan berlebihan. Sembelit â†’ kurang serat dan air. Hepatitis â†’ peradangan hati akibat virus. Pencegahan:1. Pola makan teratur. 2. Cukup serat. 3. Cukup air. 4. Menjaga kebersihan makanan. 5. Tidak berlebihan dalam konsumsi lemak dan gula.",
        "PENUTUP. Sekarang kalian memahami bahwa makanan bukan hanya untuk menghilangkan lapar. Makanan adalah Sumber energi. Bahan pembangun. Pengatur kehidupan sel Sistem pencernaan bekerja terkoordinasi dari mulut hingga anus. Setiap organ memiliki peran spesifik. Jika satu terganggu, sistem secara keseluruhan ikut terganggu. Refleksi: Jika tubuh kalian adalah sebuah sistem yang sangat teratur dan bergantung pada keseimbangan zat gizi, kebiasaan makan seperti apa yang seharusnya mulai kalian bangun sejak sekarang agar sistem itu tetap bekerja optimal sepanjang hidup? Setelah memahami bagaimana tubuh memanfaatkan zat gizi, sekarang kita akan memahami secara lebih mendasar tentang materi dan partikel penyusunnya."
    ]},
    3: { judul: "Sistem Koordinasi", icon: "ðŸ§ ", color: "purple", isi: [
        "Sistem koordinasi mengatur seluruh aktivitas tubuh melalui sistem saraf, sistem hormon, dan alat indra.",
        "Gerak refleks, seperti menarik tangan saat terkena panas, diproses dengan cepat di sumsum tulang belakang tanpa menunggu instruksi otak."
    ]},
    4: { judul: "Lingkungan Hidup", icon: "ðŸŒ", color: "green", isi: [
        "Lingkungan terdiri dari komponen Biotik (makhluk hidup) dan Abiotik (benda tak hidup seperti air, tanah, dan udara).",
        "Pencemaran lingkungan dapat mengganggu ekosistem. Pelestarian dilakukan untuk menjaga keseimbangan antara makhluk hidup dan alam sekitarnya."
    ]}
};

const bankSoal = [
    { tanya: "Mengapa udara di dalam balon disebut materi?", benar: "massa dan menempati ruang", opsi: "A. Bisa dilihat, B. Memiliki warna, C. Memiliki massa dan menempati ruang, D. Terasa dingin", penjelasan: "Udara memiliki massa dan menempati ruang ketika balon mengembang." },
    { tanya: "Es yang mencair menjadi air termasuk perubahan apa?", benar: "fisika", opsi: "A. Kimia, B. Fisika, C. Pembakaran, D. Reaksi zat baru", penjelasan: "Hanya wujudnya yang berubah tanpa terbentuk zat baru." },
    { tanya: "Pencernaan kimia karbohidrat dimulai di mana?", benar: "mulut", opsi: "A. Lambung, B. Mulut, C. Usus besar, D. Anus", penjelasan: "Enzim amilase dalam air liur mulai memecah pati di mulut." },
    { tanya: "Air, tanah, dan udara termasuk komponen apa?", benar: "abiotik", opsi: "A. Biotik, B. Abiotik, C. Organisme, D. Ekosistem", penjelasan: "Abiotik adalah komponen tidak hidup pendukung kehidupan." }
];

let currentModul = null, indexMateri = 0, soalSekarang = 0;
const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
recognition.lang = 'id-ID';

function speak(text, callback) {
    window.speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'id-ID';
    u.onend = callback;
    window.speechSynthesis.speak(u);
}

function hentikanSuara() {
    window.speechSynthesis.cancel();
    try { recognition.stop(); } catch(e) {}
    document.getElementById('statusMic').classList.add('hidden');
    document.getElementById('visualizer').classList.remove('pulse-mic');
}

function navigasiKe(id, pesan) {
    hentikanSuara();
    document.querySelectorAll('.page').forEach(p => p.classList.remove('page-active'));
    document.getElementById(id).classList.add('page-active');
    if (pesan) speak(pesan);
}

function renderModulList() {
    const container = document.getElementById('daftarModul');
    container.innerHTML = "";
    Object.keys(database).forEach(key => {
        const m = database[key];
        container.innerHTML += `<div onclick="bukaDetailMateri(${key})" class="p-6 bg-white rounded-3xl border-l-8 border-${m.color}-500 shadow-sm flex justify-between items-center cursor-pointer">
            <div><p class="text-xs font-bold text-${m.color}-500 uppercase">Modul 0${key}</p><h3 class="text-lg font-black">${m.judul}</h3></div>
            <span class="text-3xl">${m.icon}</span>
        </div>`;
    });
}

function bukaDetailMateri(id) {
    currentModul = database[id];
    indexMateri = 0;
    navigasiKe('detailMateriPage');
    document.getElementById('judulModul').innerText = currentModul.judul;
    speak("Membuka Modul " + currentModul.judul, () => setTimeout(tampilkanLangkah, 500));
}

function tampilkanLangkah() {
    const teks = currentModul.isi[indexMateri];
    document.getElementById('kontenTeks').innerText = teks;
    document.getElementById('kontenTeks').scrollTop = 0;
    speak(teks);
    document.getElementById('btnLanjut').innerText = (indexMateri === currentModul.isi.length - 1) ? "SELESAI" : "LANJUTKAN";
}

function langkahBerikutnya() {
    if(indexMateri < currentModul.isi.length - 1) { indexMateri++; tampilkanLangkah(); }
    else navigasiKe('materiPage', 'Modul selesai.');
}

function bacaUlang() { speak(currentModul.isi[indexMateri]); }

function bukaEvaluasi() {
    soalSekarang = 0;
    navigasiKe('evaluasiPage', 'Membuka evaluasi suara.');
    setTimeout(tampilkanSoalVoice, 3000);
}

function tampilkanSoalVoice() {
    if (!document.getElementById('evaluasiPage').classList.contains('page-active')) return;
    const data = bankSoal[soalSekarang];
    document.getElementById('teksPertanyaan').innerText = data.tanya;
    speak(`${data.tanya}. Pilihannya: ${data.opsi}. Sebutkan jawabanmu.`, () => {
        if (document.getElementById('evaluasiPage').classList.contains('page-active')) mulaiDengar();
    });
}

function mulaiDengar() {
    document.getElementById('statusMic').classList.remove('hidden');
    document.getElementById('visualizer').classList.add('pulse-mic');
    recognition.start();
    recognition.onresult = (e) => {
        const hasil = e.results[0][0].transcript.toLowerCase();
        hentikanSuara();
        const data = bankSoal[soalSekarang];
        if (hasil.includes(data.benar.toLowerCase())) {
            speak(`Benar! ${data.penjelasan}`, () => setTimeout(lanjutEvaluasi, 500));
        } else {
            speak(`Salah. Jawaban benar adalah ${data.benar}.`, () => setTimeout(lanjutEvaluasi, 500));
        }
    };
}

function lanjutEvaluasi() {
    if (soalSekarang < bankSoal.length - 1) { soalSekarang++; tampilkanSoalVoice(); }
    else speak("Evaluasi selesai.", () => navigasiKe('dashboardPage'));
}

function bukaHalamanInfo() {
    const konten = `
        <div class="info-section">
            <span class="info-title">Tentang Aplikasi ABIOTIK</span>
            <p class="info-text">Aplikasi ABIOTIK merupakan media pembelajaran berbasis audio-deskriptif yang dirancang khusus untuk mendukung kebutuhan siswa tunanetra dalam memahami konsep sains, khususnya materi lingkungan dan komponen abiotik.</p>    
            <p class="info-text">Aplikasi ini menghadirkan materi pembelajaran melalui pendekatan naratif, runtut, dan imajinatif sehingga pengguna dapat memahami konsep tanpa ketergantungan pada visual. Seluruh konten disusun dengan mempertimbangkan aksesibilitas, struktur bahasa yang jelas, serta kompatibilitas dengan pembaca layar (screen reader).</p>
            <p class="info-text">ABIOTIK bertujuan untuk:</p>
            <p class="info-text">â€¢	Meningkatkan akses pendidikan sains yang inklusif</p>
            <p class="info-text">â€¢	Membantu siswa tunanetra memahami konsep abstrak melalui pengalaman sensorik</p>
            <p class="info-text">â€¢	Menyediakan pusat informasi yang sistematis dan mudah diakses</p>
            <p class="info-text">â€¢	Mendukung pembelajaran mandiri yang terstruktur</p>
            <p class="info-text">Materi dalam aplikasi mencakup penjelasan konsep, kuis interaktif, refleksi berpikir, serta pusat informasi yang dapat diakses kapan saja.</p>
        </div>  
        <div class="info-section">
            <span class="info-title">SYARAT DAN KETENTUAN (S&K)</span>
            <p class="info-text">Dengan menggunakan aplikasi ABIOTIK, pengguna menyetujui ketentuan berikut:</p>
            <p class="info-text">1.	Aplikasi digunakan sebagai media pembelajaran dan bukan sebagai pengganti pembelajaran formal di sekolah.</p>
            <p class="info-text">2.	Pengguna diharapkan menggunakan aplikasi secara bertanggung jawab untuk tujuan edukasi.</p>
            <p class="info-text">3.	Pengembang berhak melakukan pembaruan materi dan sistem demi peningkatan kualitas layanan.</p>
        </div>
        <div class="info-section">
            <span class="info-title">KEBIJAKAN PENGGUNAAN</span>
            <p class="info-text">ABIOTIK dikembangkan dengan prinsip:</p>
            <p class="info-text">â€¢	Inklusif</p>
            <p class="info-text">â€¢	Aksesibel</p>
            <p class="info-text">â€¢	Edukatif</p>
            <p class="info-text">â€¢	Non-diskriminatif</p>
            <p class="info-text">Aplikasi ini memastikan:</p>
            <p class="info-text">â€¢	Semua fitur dapat diakses melalui navigasi keyboard.</p>
            <p class="info-text">â€¢	Seluruh konten dapat dibaca oleh pembaca layar. </p>
            <p class="info-text">â€¢	Bahasa yang digunakan jelas, sistematis, dan mudah dipahami.</p>
            <p class="info-text">Pengguna diimbau untuk menjaga keamanan perangkat masing-masing serta tidak menyalahgunakan sistem aplikasi.</p>
            <p class="info-text"></p>
        </div>
        <div class="info-section">
            <span class="info-title">VISI APLIKASI</span>
            <p class="info-text">Menjadi media pembelajaran sains inklusif berbasis teknologi yang mendukung kesetaraan akses pendidikan bagi siswa tunan</p>
        </div>

    `;
    document.getElementById('kontenInfo').innerHTML = konten;
    navigasiKe('infoPage', 'Membuka informasi aplikasi.');
}

document.getElementById('overlay').onclick = function() {
    this.style.display = 'none';
    speak("Aplikasi Abiotik siap.");
    renderModulList();
};